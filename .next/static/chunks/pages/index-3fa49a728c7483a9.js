(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2451)}])},3979:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var a=n(5893);n(9575);var s=n(682),o=n(4051),r=n(1555),c=n(2021),l=n(8331);function i(e){let{error:t,show:n,delay:i,handleShow:d,message:u,customClass:h}=e,p=()=>{d(!0)};return(0,a.jsx)(s.Z,{fluid:!0,children:(0,a.jsx)(o.Z,{children:(0,a.jsx)(r.Z,{children:(0,a.jsx)(c.Z,{position:h?"bottom-end":"top-end",className:"p-5",children:(0,a.jsxs)(l.Z,{position:h?"bottom-end":"",className:t?"bg-danger":"bg-success",onClose:()=>p(!1),show:n,delay:i,autohide:!0,children:[(0,a.jsxs)(l.Z.Header,{children:[(0,a.jsx)("img",{src:"holder.js/20x20?text=%20",className:"rounded me-2",alt:""}),(0,a.jsx)("strong",{className:"me-auto",children:t?"Algo deu errado":"Deu tudo certo"})]}),(0,a.jsx)(l.Z.Body,{children:t?u.error:u.success})]})})})})})}},2451:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k}});var a=n(5893),s=n(9603),o=n(213),r=n(5216);n(9575);var c=n(682),l=n(767),i=n(5005),d=n(9448),u=n(1555),h=n(4051),p=n(9332),m=n(7294),j=n(3462),x=n(1071),f=n(2619),g=n(427),S=n(6678);function Z(e){let{id:t,name:n,parent:o,handleRemove:r,handleId:l,handleShow:i,folder:d,allFolders:h}=e;return(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(S.Z,{children:(0,a.jsx)(S.Z.Item,{className:"d-flex align-items-center justify-content-between gap-2",children:(0,a.jsxs)(c.Z,{fluid:!0,className:"d-flex align-content-center justify-content-between gap-2",children:[(0,a.jsxs)(u.Z,{lg:8,className:"d-flex align-items-center gap-2",children:[null!==d.parent?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(s.G,{icon:g.lC})}):"",(0,a.jsx)(s.G,{fontSize:32,color:"#eab308",icon:j.Pk}),(0,a.jsx)("p",{className:"mb-0",children:d.name})]}),(0,a.jsxs)(u.Z,{lg:4,className:"d-flex align-items-center justify-content-end gap-2",children:[(0,a.jsx)(s.G,{fontSize:18,color:"#fd7e14",icon:x.Y,onClick:e=>{e.preventDefault(),i(!0),l(t,n,o)}}),(0,a.jsx)(s.G,{fontSize:18,color:"#dc3545",icon:f.$,onClick:e=>{e.preventDefault(),r(t)}})]})]})})}),(0,a.jsx)(c.Z,{fluid:!0,className:"px-3",children:h.filter(e=>e.parent===d.id).map(e=>(0,a.jsx)(Z,{id:e.id,name:e.name,parent:e.parent,folder:e,allFolders:h,handleRemove:r,handleShow:i,handleId:l},e.id))})]})}var v=n(2914);function C(e){let{folders:t,handleParent:n,selectedParent:s}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(v.Z.Select,{"aria-label":"Default select example",onChange:n,value:s||"",children:[(0,a.jsx)("option",{value:"",children:"/"}),t.length?(0,a.jsx)(a.Fragment,{children:t.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name},e.id))}):""]})})}function F(e){let{folders:t,selectedParent:n,inputFolder:s,setSelectedParent:o,setInputFolder:r}=e;return(0,a.jsx)(c.Z,{children:(0,a.jsxs)(v.Z,{children:[(0,a.jsxs)(v.Z.Group,{className:"mb-3",controlId:"formFolderName",children:[(0,a.jsx)(v.Z.Label,{children:"Pasta Raiz:"}),(0,a.jsx)(C,{folders:t,selectedParent:n,handleParent:e=>{o(e.target.value)}})]}),(0,a.jsxs)(v.Z.Group,{className:"mb-3",controlId:"formFolderName",children:[(0,a.jsx)(v.Z.Label,{children:"Nome da Pasta:"}),(0,a.jsx)(v.Z.Control,{value:s||"",type:"text",placeholder:"Ex: Fotos",onChange:e=>{r(e.target.value)}})]})]})})}var N=n(3979),k=()=>{let e=(0,p.useRouter)(),[t,n]=(0,m.useState)([]),[j,x]=(0,m.useState)(""),[f,g]=(0,m.useState)(""),[S,v]=(0,m.useState)(!1),[C,k]=(0,m.useState)(!1),[y,b]=(0,m.useState)(""),[E,P]=(0,m.useState)(!1),[B,R]=(0,m.useState)(""),[T,O]=(0,m.useState)(""),w=()=>{v(!1),x(""),g(""),P(!1)},D=()=>v(!0);(0,m.useEffect)(()=>{J()},[]);let J=()=>{let t=localStorage.getItem("token");void 0===t&&e.push("/");let a={method:"GET",headers:{"Content-Type":"application/json",accept:"application/json","X-CSRFToken":"SDucg4TiBJFGE6pkEpY75iXFIPBSJm2Os8APEPFSkbRLOC4aLRcvRuKAuFCBBWlu",Authorization:"Bearer ".concat(JSON.parse(t))}};fetch("".concat("https://7dev-code-test.lcc7.online/api/v1","/directories"),a).then(A).then(e=>e.json()).then(e=>{n(e)})},A=t=>(401===t.status&&(e.push("/login"),O(!0)),t),I=async()=>{let e=localStorage.getItem("token");await fetch("".concat("https://7dev-code-test.lcc7.online/api/v1","/directories"),{method:"POST",headers:{"Content-Type":"application/json",accept:"application/json","X-CSRFToken":"SDucg4TiBJFGE6pkEpY75iXFIPBSJm2Os8APEPFSkbRLOC4aLRcvRuKAuFCBBWlu",Authorization:"Bearer ".concat(JSON.parse(e))},body:JSON.stringify({name:j,parent:f})}).then(()=>{z("create"),J()})},G=async a=>{let s=localStorage.getItem("token");void 0===s&&e.push("/");let o={method:"DELETE",headers:{accept:"application/json","Content-Type":"application/json","X-CSRFToken":"SDucg4TiBJFGE6pkEpY75iXFIPBSJm2Os8APEPFSkbRLOC4aLRcvRuKAuFCBBWlu",Authorization:"Bearer ".concat(JSON.parse(s))},body:JSON.stringify({name:j,parent:f})};await fetch("".concat("https://7dev-code-test.lcc7.online/api/v1","/directory/").concat(a),o).then(A).then(()=>{z("delete"),n(t.filter(e=>e.id!==a))})},L=async()=>{let e=localStorage.getItem("token");await fetch("".concat("https://7dev-code-test.lcc7.online/api/v1","/directory/").concat(B),{method:"PATCH",headers:{"Content-Type":"application/json",accept:"application/json","X-CSRFToken":"SDucg4TiBJFGE6pkEpY75iXFIPBSJm2Os8APEPFSkbRLOC4aLRcvRuKAuFCBBWlu",Authorization:"Bearer ".concat(JSON.parse(e))},body:JSON.stringify({name:j,parent:f})}).then(()=>{z("edit"),J()})},_=(e,t,n)=>{x(t),g(n),R(e),P(!0)},X=Object.values(t).filter(e=>null===e.parent),z=e=>{let t="",n="";switch(e){case"create":t="Diret\xf3rio n\xe3o pode ser criado!",n="Diret\xf3rio criado com sucesso!";break;case"edit":t="Diret\xf3rio n\xe3o pode ser editado!",n="Diret\xf3rio editado com sucesso!";break;case"delete":t="Diret\xf3rio n\xe3o pode ser exclu\xeddo!",n="Diret\xf3rio exclu\xeddo com sucesso!";break;default:k(!1)}b({error:t,success:n}),k(!0)};return(0,a.jsxs)(c.Z,{fluid:!0,children:[(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(l.Z,{show:S,onHide:w,children:[(0,a.jsx)(l.Z.Header,{closeButton:!0,children:(0,a.jsx)(l.Z.Title,{children:"Cria\xe7\xe3o de Pastas"})}),(0,a.jsx)(l.Z.Body,{children:(0,a.jsx)(F,{folders:t,selectedParent:f,setInputFolder:x,inputFolder:j,setSelectedParent:g})}),(0,a.jsxs)(l.Z.Footer,{children:[(0,a.jsx)(i.Z,{variant:"secondary",onClick:w,children:"Fechar"}),(0,a.jsx)(i.Z,{variant:"primary",onClick:e=>{e.preventDefault(),E?L():I(),w()},children:E?"Editar":"Criar"})]})]})}),(0,a.jsx)(N.Z,{error:T,delay:2e3,handleShow:()=>{k(!1)},show:C,message:y,autohide:!0,customClass:!0}),(0,a.jsx)(d.Z,{className:"bg-body-tertiary",children:(0,a.jsxs)(c.Z,{children:[(0,a.jsxs)(i.Z,{className:"d-flex gap-2 align-items-center justify-content-center",onClick:D,children:["Pasta",(0,a.jsx)(s.G,{icon:o.EQ})]}),(0,a.jsxs)(i.Z,{className:"d-flex gap-2 align-items-center justify-content-center",onClick:t=>{t.preventDefault(),localStorage.clear(),setTimeout(()=>{e.push("/login")},2e3)},children:[(0,a.jsx)(s.G,{icon:r.mX}),"Logout"]})]})}),(0,a.jsx)(c.Z,{className:"p-4",children:(0,a.jsx)(u.Z,{children:(0,a.jsx)(h.Z,{children:X.length?X.map(e=>(0,a.jsx)(Z,{folder:e,id:e.id,name:e.name,parent:e.parent,allFolders:t,handleRemove:G,handleShow:D,handleId:_},e.id)):""})})})]})}}},function(e){e.O(0,[954,624,41,888,774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);